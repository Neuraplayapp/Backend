warning: in the working copy of 'routes/unified-route.cjs', LF will be replaced by CRLF the next time Git touches it
[1mdiff --git a/routes/unified-route.cjs b/routes/unified-route.cjs[m
[1mindex 0f5a553..d162f81 100644[m
[1m--- a/routes/unified-route.cjs[m
[1m+++ b/routes/unified-route.cjs[m
[36m@@ -50,12 +50,82 @@[m [mrouter.post('/', async (req, res) => {[m
   }[m
 });[m
 [m
[32m+[m[32m// DEVELOPMENT FALLBACK: Provides mock responses when using demo API keys[m
[32m+[m[32masync function handleDemoFireworksResponse(endpoint, data, res) {[m
[32m+[m[32m  switch (endpoint) {[m
[32m+[m[32m    case 'llm-completion':[m
[32m+[m[32m      // Mock LLM response for chat completions[m
[32m+[m[32m      const mockResponse = {[m
[32m+[m[32m        choices: [{[m
[32m+[m[32m          message: {[m
[32m+[m[32m            role: 'assistant',[m
[32m+[m[32m            content: `This is a demo response for development. Your message was: "${data.messages?.slice(-1)[0]?.content || 'No message'}"`,[m
[32m+[m[32m            tool_calls: data.messages?.some(m => m.content?.includes('canvas') || m.content?.includes('image') || m.content?.includes('chart')) ? [{[m
[32m+[m[32m              id: 'demo_tool_call',[m
[32m+[m[32m              type: 'function',[m
[32m+[m[32m              function: {[m
[32m+[m[32m                name: 'canvas-document-creation',[m
[32m+[m[32m                arguments: JSON.stringify({[m
[32m+[m[32m                  content: `# Demo Canvas Document\n\nThis is a demo response for development mode. The system detected your request and created this placeholder content.\n\n**Your request:** ${data.messages?.slice(-1)[0]?.content || 'Canvas request'}\n\n**Status:** Development mode - using fallback responses.`,[m
[32m+[m[32m                  mode: 'create'[m
[32m+[m[32m                })[m
[32m+[m[32m              }[m
[32m+[m[32m            }] : undefined[m
[32m+[m[32m          },[m
[32m+[m[32m          finish_reason: 'stop'[m
[32m+[m[32m        }],[m
[32m+[m[32m        model: data.model || 'demo-model',[m
[32m+[m[32m        usage: { prompt_tokens: 10, completion_tokens: 25, total_tokens: 35 }[m
[32m+[m[32m      };[m
[32m+[m[32m      return res.json(mockResponse);[m
[32m+[m
[32m+[m[32m    case 'vision':[m
[32m+[m[32m      // Mock vision analysis response[m
[32m+[m[32m      const visionResponse = {[m
[32m+[m[32m        choices: [{[m
[32m+[m[32m          message: {[m
[32m+[m[32m            role: 'assistant',[m
[32m+[m[32m            content: 'This is a demo vision analysis response. In development mode, I cannot actually analyze images, but this simulates the expected response format for testing purposes.'[m
[32m+[m[32m          },[m
[32m+[m[32m          finish_reason: 'stop'[m
[32m+[m[32m        }],[m
[32m+[m[32m        model: 'demo-vision-model',[m
[32m+[m[32m        usage: { prompt_tokens: 15, completion_tokens: 30, total_tokens: 45 }[m
[32m+[m[32m      };[m
[32m+[m[32m      return res.json(visionResponse);[m
[32m+[m
[32m+[m[32m    case 'image-generation':[m
[32m+[m[32m      // Mock image generation response[m
[32m+[m[32m      const imageResponse = {[m
[32m+[m[32m        success: true,[m
[32m+[m[32m        images: [{[m
[32m+[m[32m          url: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTEyIiBoZWlnaHQ9IjUxMiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iNTEyIiBoZWlnaHQ9IjUxMiIgZmlsbD0iIzM0OTVmZiIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMjQiIGZpbGw9IndoaXRlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkeT0iLjNlbSI+RGVtbyBJbWFnZTwvdGV4dD48L3N2Zz4=',[m
[32m+[m[32m          revised_prompt: `Demo image for: ${data.prompt || 'development testing'}`[m
[32m+[m[32m        }],[m
[32m+[m[32m        metadata: { model: 'demo-image-model', mode: 'development' }[m
[32m+[m[32m      };[m
[32m+[m[32m      return res.json(imageResponse);[m
[32m+[m
[32m+[m[32m    default:[m
[32m+[m[32m      return res.status(400).json({ error: `Demo mode: Unsupported endpoint ${endpoint}` });[m
[32m+[m[32m  }[m
[32m+[m[32m}[m
[32m+[m
 async function handleFireworksRequest(endpoint, data, res) {[m
   const apiKey = process.env.Neuraplay || process.env.FIREWORKS_API_KEY || process.env.VITE_FIREWORKS_API_KEY;[m
   if (!apiKey) {[m
     return res.status(500).json({ error: 'Fireworks API key not configured' });[m
   }[m
 [m
[32m+[m[32m  // DEVELOPMENT MODE: Detect demo/placeholder keys and provide fallback responses[m
[32m+[m[32m  const isDemoKey = apiKey === 'fireworks' || apiKey === 'demo-fireworks-key' || apiKey.includes('demo') || apiKey.includes('placeholder');[m
[32m+[m[32m  const isDevelopment = process.env.NODE_ENV === 'development';[m
[32m+[m[41m  [m
[32m+[m[32m  if (isDemoKey && isDevelopment) {[m
[32m+[m[32m    console.log('ðŸŽ­ Demo mode: Using fallback response for endpoint:', endpoint);[m
[32m+[m[32m    return handleDemoFireworksResponse(endpoint, data, res);[m
[32m+[m[32m  }[m
[32m+[m
   switch (endpoint) {[m
     case 'image-generation':[m
       try {[m
[36m@@ -339,3 +409,73 @@[m [masync function handleElevenLabsRequest(endpoint, data, res) {[m
 }[m
 [m
 module.exports = router;[m
[32m+[m[32mCreate documents that are:[m
[32m+[m[32mâœ“ Thoroughly researched and informative[m
[32m+[m[32mâœ“ Well-organized with clear sections[m
[32m+[m[32mâœ“ Rich in detail and examples[m
[32m+[m[32mâœ“ Professional and engaging[m
[32m+[m[32mâœ“ Comprehensive and complete[m
[32m+[m
[32m+[m[32mNEVER create short or sparse content. Always provide full, detailed information.`[m
[32m+[m[32m            }, {[m
[32m+[m[32m              role: 'user',[m
[32m+[m[32m              content: `Create a comprehensive ${type || 'document'} about: ${prompt}`[m
[32m+[m[32m            }],[m
[32m+[m[32m            temperature: 0.7,[m
[32m+[m[32m            max_tokens: 4000 // More tokens for comprehensive content[m
[32m+[m[32m          })[m
[32m+[m[32m        });[m
[32m+[m
[32m+[m[32m        const result = await response.json();[m
[32m+[m[32m        const content = result.choices[0].message.content;[m
[32m+[m[41m        [m
[32m+[m[32m        // Extract title from first heading or generate one[m
[32m+[m[32m        const titleMatch = content.match(/^#\s+(.+)$/m);[m
[32m+[m[32m        const title = titleMatch ? titleMatch[1] : `${type || 'Document'}: ${prompt.substring(0, 50)}`;[m
[32m+[m[41m        [m
[32m+[m[32m        return res.json({[m
[32m+[m[32m          success: true,[m
[32m+[m[32m          data: {[m
[32m+[m[32m            content,[m
[32m+[m[32m            title,[m
[32m+[m[32m            type: type || 'document',[m
[32m+[m[32m            wordCount: content.split(/\s+/).length,[m
[32m+[m[32m            metadata: {[m
[32m+[m[32m              generatedAt: Date.now(),[m
[32m+[m[32m              model: 'llama-v3p1-70b-instruct',[m
[32m+[m[32m              comprehensiveness: 'maximum'[m
[32m+[m[32m            }[m
[32m+[m[32m          }[m
[32m+[m[32m        });[m
[32m+[m[32m      } catch (error) {[m
[32m+[m[32m        return res.status(500).json({ error: error.message });[m
[32m+[m[32m      }[m
[32m+[m
[32m+[m[32m    default:[m
[32m+[m[32m      return res.status(400).json({ error: `Unknown Fireworks endpoint: ${endpoint}` });[m
[32m+[m[32m  }[m
[32m+[m[32m}[m
[32m+[m
[32m+[m[32masync function handleTogetherRequest(endpoint, data, res) {[m
[32m+[m[32m  const apiKey = process.env.together_token || process.env.TOGETHER_API_KEY;[m
[32m+[m[32m  if (!apiKey) {[m
[32m+[m[32m    return res.status(500).json({ error: 'Together AI API key not configured' });[m
[32m+[m[32m  }[m
[32m+[m[41m  [m
[32m+[m[32m  // Implement Together AI routing here[m
[32m+[m[32m  return res.status(501).json({ error: 'Together AI routing not implemented yet' });[m
[32m+[m[32m}[m
[32m+[m
[32m+[m[32m